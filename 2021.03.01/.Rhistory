coef.mat
coef.mat = cbind(row1, row2, row3)
coef.mat
coef.mat[1,]
coef.mat[1, ]
coef.mat[,1]
coef.mat[,2]
coef.mat["row1",]
coef.mat[,c("row1")]
coef.mat[,"row1"]
coef.mat[,"row2"]
coef.mat[,c(T,T,F)]
coef.mat[c(F,T,F),c(T,T,F)]
coef.mat
coef.mat == 1
iris
iris
iris[,"Petal.Width"] > 11
iris[,"Petal.Width"] > 1
iris[iris[,"Petal.Width"] > 1],]
iris[iris[,"Petal.Width"] > 1,]
coef.mat -> mat.tmp
mat.tmp
c(1,2,3) -> abss
abss
i.mat = matrix(c(2,3,4,1,4,4,5,6), ncol =2,
byrow = T)
dimnames(i.mat) = list(c("index1",
"index2",
"index3",
"index3"),
c("row","col"))
i.mat
dimnames(i.mat) = list(c("index1",
"index2",
"index3",
"index3"),
c("col1","col2"))
i.mat
G = function(n) {
a = 0
for(i in 1:n) {
a = a + i
}
print(a)
}
G(15)
G = function(n) {
sum(1:n)
}
G(15)
FS = function(n) {
a1 = 1
a2 = 1
a = c(a1, a2)
for(i in 3:n) {
an = a1 + a2
a = c(a, an)
a1 = a2
a2 = an
}
return(a)
}
FS(55)
FS(55)[55]
FS = function(n) {
a1 = 1
a2 = 1
a = c(a1, a2)
for(i in 3:n) {
an = a1 + a2
a = c(a, an)
a1 = a2
a2 = an
}
return(sum(a))
}
FS(55)
FS = function(n) {
a1 = 1
a2 = 1
a = c(a1, a2)
for(i in 3:n) {
an = a1 + a2
a = c(a, an)
a1 = a2
a2 = an
}
return(a)
}
FS(55)
FS(55)[55]
airquality
airquality[!is.na(airquality)]
na.omit(airquality)
airquality1 = c()
for(i in 1:nrow(airquality)) {
if(sum(is.na(airquality[i,])) == 0) airquality1 = rbind(airquality1,airquality[i,])
}
airquality1
airq = c()
for(i in 1:nrow(airquality)) {
if( sum(is.na(airquality[i, ])) == 0 ) airq = rbind(airq,airquality[i, ])
}
na.omit(airquality)
airq
na.omit(airquality) == airq
data = c()
for( i in 1:200) {
a = sample(1:100, size = 10, replace = F)
b = mean(b)
data = c(data,b)
}
data = c()
for( i in 1:200) {
a = sample(1:100, size = 10, replace = F)
b = mean(a)
data = c(data,b)
}
plot(density(data))
plot(density(data))
data = c()
for( i in 1:5000) {
a = sample(1:100, size = 10, replace = F)
b = mean(a)
data = c(data,b)
}
plot(density(data))
data = c()
for( i in 1:20000) {
a = sample(1:100, size = 10, replace = F)
b = mean(a)
data = c(data,b)
}
plot(density(data))
data = c()
for( i in 1:100000) {
a = sample(1:100, size = 10, replace = F)
b = mean(a)
data = c(data,b)
}
plot(density(data))
plot(density(scale(data)))
data = c()
for( i in 1:20000) {
a = sample(1:100, size = 30, replace = F)
b = mean(a)
data = c(data,b)
}
mean(data) ; sd(data)
for( i in 1:100000) {
a = sample(1:100, size = 30, replace = F)
b = mean(a)
data = c(data,b)
}
mean(data) ; sd(data)
plot(dnorm(m=50, sd = 4.5))
plot(dnorm(seq(-4,4,length = 1000 ) ,m=50, sd = 4.5))
plot(seq(-4,4,length = 1000 ),dnorm(seq(-4,4,length = 1000 ) ,m=50, sd = 4.5))
plot(dnorm(seq(-4,4,length = 1000 ) ,m=50, sd = 4.5)~seq(-4,4,length = 1000 ))
dnorm(seq(-4,4,length = 1000 ) ,m=50, sd = 4.5)
plot(dnorm(seq(45,55,length = 1000 ) ,m=50, sd = 4.5)~seq(-45,55,length = 1000 ))
data = read.table("clipboard",sep = "", header=T)
data
data = read.table("clipboard",sep = "", header=T)
data = read.table("clipboard",sep = "", header=T)
data
data = read.table("clipboard",sep = "", header=T)
data
data = read.table("clipboard",sep = "", header=T)
data
My.omit = function(data) {
vacan = c()
for(i in 1:nrow(data)) {
if( sum(is.na(data[i,])) == 0 ) vacan = c(vacan,data[i,])
}
return(vacan)
}
My.omit(airquality)
if( sum(is.na(data[i,])) == 0 ) vacan = rbind(vacan,data[i,])
My.omit = function(data) {
vacan = c()
for(i in 1:nrow(data)) {
if( sum(is.na(data[i,])) == 0 ) vacan = rbind(vacan,data[i,])
}
return(vacan)
}
My.omit(airquality)
na.omit(airquality)
My.omit(airquality) == na.omit(airquality)
load("C:/Users/junkyu/Desktop/ISTANS ê³µëª¨??ëª¨í˜•ê²°ê³¼ ?´ê²Œ ì§„ì§œ.RData")
garch.spec.m<-ugarchspec(variance.model=list(model="sGARCH",garchOrder=c(1,1)),
mean.model=list(armaOrder=c(1,1)),
distribution.model="norm")
garch.spec.i<-ugarchspec(variance.model=list(model="sGARCH",garchOrder=c(1,1)),
mean.model=list(armaOrder=c(1,1)),
distribution.model="norm")
setbounds(garch.spec.m) = list(omega=c(0,1), alpha1 = c(0,1), beta1 = c(0.1))
setbounds(garch.spec.i) = list(omega=c(0,1), alpha1 = c(0,1), beta1 = c(0,1))
mspec<-multispec(c(garch.spec.m,garch.spec.i))
dcc.spec<-dccspec(mspec,dccOrder=c(1,1),model="DCC",distribution="mvnorm")
pnorm(3)
1-pnorm(3)
B = function(a,b) {
length.value = abs(b - a + 1)
sum.value = b + a
result = (sum.value*length.value)/2
return(result)
}
B(10,1)
B = function(a,b) {
length.value = abs(b - a) + 1
sum.value = b + a
result = (sum.value*length.value)/2
return(result)
}
B(10,1)
B(1,10)
B(2,11)
B(11,2)
3*(3^8-1)/2
3*(3^9-1)/2
3^9
1*(3^9-1)/2
3^11
1*(3^12-1)/2
1*(3^15-1)/2
1*(3^17-1)/2
1*(3^16-1)/2
solution = function(citations) {
answer = c()
lenum = length(citations)
for(i in 1:lenum){
MaxH = 0
MinH = 0
number = citations[i]
for(j in 1:lenum){
if (number <= citations[j]) MaxH =+ 1 else
if (number > citations[j])  MinH =+ 1
if MaxH > MinH:
}
answer = c(answer, MaxH)
}
return(max(answer))
}
if (number > citations[j])  MinH = MinH + 1
solution = function(citations) {
answer = c()
lenum = length(citations)
for(i in 1:lenum){
MaxH = 0
MinH = 0
number = citations[i]
for(j in 1:lenum){
if (number <= citations[j]) MaxH = MaxH + 1 else
if (number > citations[j])  MinH = MinH + 1
if MaxH > MinH:
}
answer = c(answer, MaxH)
}
return(max(answer))
}
MaxH = 0
solution = function(citations) {
answer = c()
lenum = length(citations)
for(i in 1:lenum){
MaxH = 0
MinH = 0
number = citations[i]
for(j in 1:lenum){
if(number <= citations[j]) MaxH = MaxH + 1 else
if(number > citations[j])  MinH = MinH + 1
}
if (MaxH > MinH) answer = c(answer, MaxH)
}
return(max(answer))
}
solution(c(3,0,6,1,5))
library(MASS)
mcars
mtcars
plot(mtcars)
library(MASS)
loc = cmdscale(eurodist)
loc
x = loc[,1]
y = -loc[,2]
x
y
plot(x,y, type= "n", asp = 1, main = "Metrix MDS")
text(x,y, rownames(loc), cex = 0.7)
abline(v = 0, h = 0, lty = 2, lwd = 0.5)
plot(x,-y, type= "n", asp = 1, main = "Metrix MDS")
text(x,-y, rownames(loc), cex = 0.7)
abline(v = 0, h = 0, lty = 2, lwd = 0.5)
par(mfrow = c(2,1))
plot(x,-y, type= "n", asp = 1, main = "Metrix MDS")
text(x,-y, rownames(loc), cex = 0.7)
abline(v = 0, h = 0, lty = 2, lwd = 0.5)
par(mfrow = c(2,1))
plot(x,-y, type= "n", asp = 1, main = "Metrix MDS")
par(mfrow = c(2,1))
plot(x,-y, type= "n", asp = 1, main = "Metrix MDS")
par(mfrow = c(1,2))
plot(x,-y, type= "n", asp = 1, main = "Metrix MDS")
text(x,-y, rownames(loc), cex = 0.7)
abline(v = 0, h = 0, lty = 2, lwd = 0.5)
plot(x,y, type= "n", asp = 1, main = "Metrix MDS")
text(x,y, rownames(loc), cex = 0.7)
abline(v = 0, h = 0, lty = 2, lwd = 0.5)
eurodist
sqrt(30-2)*0.4438678/sqrt(1-0.4438678^2)
qt(df = 28, 0.05. lower.tail = F)
qt(df = 28, 0.05, lower.tail = F)
qt(df = 28, 0.025, lower.tail = F)
pt(df = 28, sqrt(30-2)*0.4438678/sqrt(1-0.4438678^2), lower.tail = F)
library(dplyr)
F = function(b) {
a1 = 1 # ì²«ì§¸???¤ì •
a2 = 1 # ?˜ì§¸???¤ì •
for(i in 1:(n-2)) {
an = a1 + a2 # ?¼ë³´?˜ì¹˜ ?í™”???¤ì •
a1 = a2       # a1 ????ì¦ê?
a2 = an       # a2 ????ì¦ê?
}
return(an) # në²ˆì§¸ ??ì¶œë ¥
}
F(10)
F = function(n) {
a1 = 1 # ì²«ì§¸???¤ì •
a2 = 1 # ?˜ì§¸???¤ì •
for(i in 1:(n-2)) {
an = a1 + a2 # ?¼ë³´?˜ì¹˜ ?í™”???¤ì •
a1 = a2       # a1 ????ì¦ê?
a2 = an       # a2 ????ì¦ê?
}
return(an) # në²ˆì§¸ ??ì¶œë ¥
}
F(10)
?matrix
age = c(20, 30, 40, 50)
gender = c("F","M","M","F")
income = c(1000, 2000, 3000, 4000)
region = c("S","S","G","G")
df = data.frame(age = age, gender = gender, income = income, region = region)
df
library(reshape)
df.melt = melt(df, id.vars = c("gender","region"))
df.melt
cast(df.melt, gender+region ~ variable)
cast(df.melt, gender + variable ~ region)
cast(df.melt, gender ~ variable + region)
df.melt
df
df.melt
cast(df.melt, gender ~ variable + region)
cast(df.melt, gender ~  region + variable)
df
df.melt
cast(df.melt, gender ~  region + variable)
cast(df.melt, gender + variable ~ region )
data = read.table("clipboard", sep = "\t", header=T)
str(data)
data[,6] = as.Date(data[,6])
str(data)
summary(data)
lm(?ë°œ?Ÿìˆ˜ ~ ?±ë³„ + ?˜ì´ + ?Œì½œ?ë„, data = data)
str(data)
data[,4] = as.numeric(data[,4])
lm(?ë°œ?Ÿìˆ˜ ~ ?±ë³„ + ?˜ì´ + ?Œì½œ?ë„, data = data)
summary(data)
data = read.table("clipboard", sep = "\t", header=T)
str(data)
data[,6] = as.Date(data[,6])
data[,4] = as.numeric(data[,4])
str(data)
lm(?ë°œ?Ÿìˆ˜ ~ ?±ë³„ + ?˜ì´ + ?Œì½œ?ë„, data = data)
summary(lm(?ë°œ?Ÿìˆ˜ ~ ?±ë³„ + ?˜ì´ + ?Œì½œ?ë„, data = data))
summary(step(lm(?ë°œ?Ÿìˆ˜ ~ ?±ë³„ + ?˜ì´ + ?Œì½œ?ë„, data = data)))
data = read.table("clipboard", sep = "\t", header=T)
data[,5] = as.Date(data[,5])
data[,3] = as.numeric(data[,3])
summary(step(lm(?ë°œ?Ÿìˆ˜ ~ ?±ë³„ + ?˜ì´ + ?Œì½œ?ë„, data = data)))
str(data)
str(data)
data[data[,2] == 1,]
nrow(data[data[,2] == 1,])
nrow(data[data[,2] == 2,])
nrow(data[data[,2] == 3,])
nrow(data[data[,2] == 4,])
dat = read.table("clipboard", sep = "\t", header=T)
plot(dat[,2])
plot(dat[,2], type = "l")
str(data)
plot(data[,3] ~ data[,4], type = "l")
plot(data[,3] ~ data[,4])
data[,3]
str(data)
plot(density(data[,3]))
dat
dat
length(dat[,2])
dat[,2][1:14]
dat[,2][15:29]
t.test(dat[,2][1:14],dat[,2][15:29])
?t.test
t.test(dat[,2][1:14],dat[,2][15:29],paired = T)
t.test(dat[,2][2:14],dat[,2][15:29],paired = T)
dat[,2][2:14]
dat[,2][15:29]
t.test(dat[,2][1:14],dat[,2][16:29], paired = T)
t.test(dat[,2][1:14],dat[,2][16:29], paired = F)
sample(c(1,2,3,4,5), 1)
sample(c(1,2,4,5), 1)
sample(c(1,2,5), 1)
sample(c(1,2), 1)
sample(c(1,2,3,4),1)
1+1
q()
devtools::install_github("gadenbuie/rsthemes")
data('mtcars')
data(mtcars)
str(mtcars)
mtcars$cyl = as.factor(mtcars$cyl)
mtcars$am = as.factor(mtcars$am)
str(mtcars)
car = mtcars[, c("cyl", "am", "mpg")]
str(car)
car_aov = aov(mpg ~ cyl * am, car)
summary(car_aov)
interaction.plot(car$cyl, car$am, car$mpg, col = c("red", "blue"))
credit
setwd('C:/Users/junkyu/Desktop/DATA ANALYSIS/2021.03.01')
credit = read.table('clipboard', header=T, seq = '\t')
credit = read.table('clipboard', header=T, sep = '\t')
str(credit)
class(credit$credit.rating)
credit$credit.rating = factor(credit$credit.rating) # ì¢…ì†ë³€ìˆ˜ë¥¼ factorë¡œ ë³€í™˜
str(credit)
# ë°ì´í„° ì…‹ ë¶„í• , train: 70%, test: 30%
set.seed(123)
idx = sample(1:nrow(credit), nrow(credit)*0.7, replace = F) # ë¬´ì‘ìœ„ ë‚œìˆ˜ ì¶”ì¶œ
train = credit[idx,] # train
test = credit[-idx,] # test#
logistic = glm(credit.rating~., data = train, family = 'binomial')
summary(logistic)
step_logistic =step(logistic)
step_logistic
step_logistic = step(logistic, direction = 'both')
summary(step_logistic)
step.logistic<-step(glm(credit.rating~1, data=train, family="binomial"),
scope=list(lower=~1, upper=~account.balance+credit.duration.months+previous.credit.payment.status+
credit.purpose+credit.amount+savings+employment.duration+installment.rate+
marital.status+guarantor+residence.duration+current.assets+age+other.credits+
apartment.type+bank.credits+occupation+dependents+telephone+foreign.worker),
direction="both") # directionì„ ì´ìš©í•˜ì—¬ ë‹¨ê³„ì  ì„ íƒë²•ì„ ì§€ì •í•˜ì˜€ìŒ.
summary(step.logistic)
# ì˜ˆì¸¡ì„ í†µí•œ ì •ë¶„ë¥˜ìœ¨ í™•ì¸
install.packages('caret')
library(caret)
summary(step.logistic) #í™•ì¸ê²°ê³¼ 13ê°œì˜ ë³€ìˆ˜ê°€ ì„ íƒë¨.
pred = predict(ste_logistic, test[,-1], type = 'response') # ì˜ˆì¸¡ê°’ì„ 'response'ë¡œ ì§€ì •í•˜ì—¬ í™•ë¥ ê°’ì„ ì¶œë ¥
pred = predict(step_logistic, test[,-1], type = 'response') # ì˜ˆì¸¡ê°’ì„ 'response'ë¡œ ì§€ì •í•˜ì—¬ í™•ë¥ ê°’ì„ ì¶œë ¥
pred1 = as.data.frame(pred)
pred1
pred
pred1$grade = ifelse(pred1$pred < 0.5, pred1$grade = 0, pred1$grade = 1)
pred1$grade = ifelse(pred1$pred < 0.5, pred1$grade <- 0, pred1$grade <- 1)
confusionMatrix(data=as.factor(pred1$grade), reference = test[,1], positive = '1')
install.packages('e1071')
library(e1071)
confusionMatrix(data=as.factor(pred1$grade), reference = test[,1], positive = '1')
step_logistic<-step(glm(credit.rating~1, data=train, family="binomial"),
scope=list(lower=~1, upper=~account.balance+credit.duration.months+previous.credit.payment.status+
credit.purpose+credit.amount+savings+employment.duration+installment.rate+
marital.status+guarantor+residence.duration+current.assets+age+other.credits+
apartment.type+bank.credits+occupation+dependents+telephone+foreign.worker),
direction="both") # directionì„ ì´ìš©í•˜ì—¬ ë‹¨ê³„ì  ì„ íƒë²•ì„ ì§€ì •í•˜ì˜€ìŒ.
pred = predict(step_logistic, test[,-1], type = 'response') # ì˜ˆì¸¡ê°’ì„ 'response'ë¡œ ì§€ì •í•˜ì—¬ í™•ë¥ ê°’ì„ ì¶œë ¥ 1-1
pred1 = as.data.frame(pred)
pred1$grade = ifelse(pred1$pred < 0.5, pred1$grade <- 0, pred1$grade <- 1) # 1-2
confusionMatrix(data=as.factor(pred1$grade), reference = test[,1], positive = '1') # 1-3
# ROC ì»¤ë¸Œ ê·¸ë¦¬ê¸° ë° AUC ì‚°ì¶œ
install.packages('ROCR')
library(ROCR)
plot(performance(pred_logistic_roc, 'tpr', 'fpr'))
pred_logistic_roc = prediction(as.numeric(pred1.grade), as.numeric(test[,1]))
pred_logistic_roc = prediction(as.numeric(pred1$grade), as.numeric(test[,1]))
plot(performance(pred_logistic_roc, 'tpr', 'fpr'))
abline(a = 0, b = 1, lty = 2, col = "black")
performance(pred_logistic_roc, 'tpr', 'fpr')$y.value
performance(pred_logistic_roc, 'tpr', 'fpr')@y.value
performance(pred_logistic_roc, 'auc')@y.value
performance(pred_logistic_roc, 'auc')@y.values
pred_logistic_roc = prediction(as.numeric(pred1$grade), as.numeric(test[,1]))
plot(performance(pred_logistic_roc, 'tpr', 'fpr'))
abline(a = 0, b = 1, lty = 2, col = "black")
performance(pred_logistic_roc, 'auc')@y.values
library(nnet)
idx = sample(1:nrow(iris), nrow(iris)*0.7, replace = F)
train_iris = iris[idx, ]
test_iris = iris[-idx, ]
mul.iris = multinom(Species~., train_iris)
# train ë°ì´í„°ë¡œ ë‹¤í•­ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¶„ì„ ì‹¤ì‹œ
mul_iris = multinom(Species~., train_iris)
# ì˜ˆì¸¡ì„ í†µí•œ ì •ë¶„ë¥˜ìœ¨ í™•ì¸
pred_mul = predict(mul_iris, test_iris[,-5])
confusionMatrix(pred_mul, test_iris[,5])
# iris ë°ì´í„° train, testë¡œ ë¶„í•  0.7, 0.3
str(iris)
save.image("C:/Users/junkyu/Desktop/DATA ANALYSIS/2021.03.01/ë¡œì§€ìŠ¤í‹± íšŒê·€ ì‹¤ìŠµ.RData")
